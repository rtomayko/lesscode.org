<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" 
        content="text/html; charset=UTF-8" />

  <title>  Ruby</title>
	<meta name="generator" content="WordPress 2.0.1" />

	<link rel="stylesheet" href="http://lesscode.org/wp-content/themes/almodovar/style.css" type="text/css" media="screen" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://lesscode.org/feed/" />
	<link rel="alternate" type="text/xml" title="RSS .92" href="http://lesscode.org/feed/rss/" />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://lesscode.org/feed/atom/" />
	<link rel="pingback" href="http://lesscode.org/xmlrpc.php" />

        <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
        </script>
        <script type="text/javascript">
        _uacct = "UA-125803-1";
        urchinTracker();
        </script>
		<link rel='archives' title='October 2006' href='http://lesscode.org/2006/10/' />
	<link rel='archives' title='April 2006' href='http://lesscode.org/2006/04/' />
	<link rel='archives' title='March 2006' href='http://lesscode.org/2006/03/' />
	<link rel='archives' title='January 2006' href='http://lesscode.org/2006/01/' />
	<link rel='archives' title='December 2005' href='http://lesscode.org/2005/12/' />
	<link rel='archives' title='November 2005' href='http://lesscode.org/2005/11/' />
	<link rel='archives' title='October 2005' href='http://lesscode.org/2005/10/' />
	<link rel='archives' title='September 2005' href='http://lesscode.org/2005/09/' />
	<link rel='archives' title='August 2005' href='http://lesscode.org/2005/08/' />
	<link rel='archives' title='July 2005' href='http://lesscode.org/2005/07/' />
	<link rel='archives' title='June 2005' href='http://lesscode.org/2005/06/' />
	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://lesscode.org/xmlrpc.php?rsd" />
</head>
<body>

<div id="page">
<h1><a href="http://lesscode.org">lesscode.org</a></h1>
<div id="navcontainer">
		<ul id="navlist">
			<li class="page_item"><a href="http://lesscode.org/archives/" title="archives">archives</a></li>
<li class="page_item"><a href="http://lesscode.org/about/" title="about lesscode.org">about lesscode.org</a></li>
		</ul>
</div>
<hr />

	<div id="content" class="narrowcolumn">

		
		 		<h2>'Ruby' Archives</h2>

 	  
				<div class="post">
				<h2 id="post-124"><a href="http://lesscode.org/2006/01/08/ruby-on-rails-is-like-red-wine/" rel="bookmark" title="Permanent Link to Ruby On Rails Is Like Red Wine">Ruby On Rails Is Like Red Wine</a>&nbsp;&nbsp;<span><a href="http://lesscode.org/2006/01/08/ruby-on-rails-is-like-red-wine/#comments" title="Comment on Ruby On Rails Is Like Red Wine">32</a> </span></h2>
				<small>Cat.: <a href="http://lesscode.org/category/languages/ruby/" title="View all posts in Ruby" rel="category tag">Ruby</a><br />08. January 2006</small>

				<div class="entry">
					<p>Fifteen, twenty years ago North America was a culinary wasteland, save for the rare pockets scattered along east, west and south coasts. A brief trip to places like New Orleans would shock and jolt the palate of the plain white crustless bread, stake-and-potatoes visitors. Of course, let&#8217;s not forget other fine culinary spots, such as Manhattan, San Francisco, and several other islands in the otherwise homogenous sea of mediocrity.</p>

<p>Things started to change rapidly in the nineties, reaching levels of unprecedented sophistication in dinning and wining. Today, we can enjoy the incredibly opulent selection offered to us through stores such as <a href="http://www.wholefoodsmarket.com/">The Whole Paycheck</a> (er, <a href="http://www.wholefoodsmarket.com/">Whole Foods</a>), but things were drastically different only fifteen years ago.</p>

<p>I remember how unpopular wine drinking was not that long ago. Especially in my neck of the woods (I live in Vancouver, British Columbia, where most locals still mentally inhabit the 19th century time zone). Up until very recently, this was a beer country. All normal, regular males were expected to drink beer. Wine was mostly available in those hideous 4 litre carton boxes, and tasted like pee that went bad. Anyone caught preferring or, god forbid, drinking wine was declared gay on the spot. It used to be very hard to smuggle a bottle of import wine into one&#8217;s apartment.</p>

<p>At social gatherings, wine drinking was reserved for the female population. Men were either expected to chug beer, or go with some hard booze.</p>

<p>Luckily, things started changing for the better, and now we have pretty decent selection of import wines from all around the world. Plus, straight men are not afraid that they&#8217;ll be labelled as &#8216;faggots&#8217; if they are seen drinking wine in public.</p>

<h3>What Does Wine Have to Do With Ruby on Rails?</h3>

<p>Programming languages and development platforms are kind of similar to alcoholic beverages. Majority of software developers choose products that belong to the beer category. Sure, there&#8217;s plenty of variety there, but in the final analysis, it&#8217;s all beer after all. Thus programming languages such as Pascal, Perl, Java, C#, ColdFusion, PHP etc. are basically just different varieties of beer (like, dark beer, pale ale, lager, etc.) Languages such as Assembler and C are more like hard liqueurs (e.g. whiskey, tequila, vodka). Languages such as Smalltalk, Python, Lisp, are like white wine &#8212; sophisticated and enchanting.</p>

<p>Finally, languages like Ruby (with all its domain specific flavors, such as Rake and Ruby on Rails) are like red wine. Red wine is that special gamut of products that demand incredibly high level of devotion and finesse, thus creating its own breed of aficionados.</p>

<p>And like the friction that wine drinkers were having with the overruling beer crowd, Ruby and Ruby on Rails users are today experiencing similar friction coming from the &#8216;beer crowd&#8217; of programming languages. Most of the dissent seems to be coming from the &#8216;plain vanilla&#8217; lager crowd (the Java consumers). There&#8217;s also some dissent coming from the &#8216;white wine&#8217; crowd, but in a much more civilized fashion.</p>

<p>I wonder if the same cultural evolution, that helped promote the spreading of the red wine culture throughout North America, will happen for the &#8216;red wine of software development&#8217;, that is, for Ruby on Rails? At this point, it doesn&#8217;t seem very likely, as anyone who&#8217;s using Rails seems to be labelled in a knee-jerk fashion as being &#8216;queer&#8217;. It is obvious that the mainstream crowd of software developers (i.e. the beer drinking crowd) is extremely uncomfortable with the uprising of the red wine drinking crowd (i.e. the Ruby on Rails). The beer drinking crowd confesses that they simply don&#8217;t get what could possibly be so enchanting about enjoying the red wine.</p>

<p>Hopefully, cooler heads will prevail, and the medical findings that red wine is actually beneficial for one&#8217;s health will pave the way toward adopting the red wine consumption on a larger scale.</p>
				</div>

				<!--
				<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
	    xmlns:dc="http://purl.org/dc/elements/1.1/"
	    xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://lesscode.org/2006/01/08/ruby-on-rails-is-like-red-wine/"
    dc:identifier="http://lesscode.org/2006/01/08/ruby-on-rails-is-like-red-wine/"
    dc:title="Ruby On Rails Is Like Red Wine"
    trackback:ping="http://lesscode.org/2006/01/08/ruby-on-rails-is-like-red-wine/trackback/" />
</rdf:RDF>				-->
			</div>

				<div class="post">
				<h2 id="post-114"><a href="http://lesscode.org/2005/12/13/logging-microformats/" rel="bookmark" title="Permanent Link to Logging microformats">Logging microformats</a>&nbsp;&nbsp;<span><a href="http://lesscode.org/2005/12/13/logging-microformats/#comments" title="Comment on Logging microformats">10</a> </span></h2>
				<small>Cat.: <a href="http://lesscode.org/category/languages/python/" title="View all posts in Python" rel="category tag">Python</a>,  <a href="http://lesscode.org/category/languages/ruby/" title="View all posts in Ruby" rel="category tag">Ruby</a>,  <a href="http://lesscode.org/category/by-stack/microformats/" title="View all posts in microformats" rel="category tag">microformats</a><br />13. December 2005</small>

				<div class="entry">
					<p>Here&#8217;s a slightly elided log line from a system I work with:</p>

<pre >
<font color='blue'>WARN 2005-09-28 14:38:38 StandardContext[/pmr]  {&#8221;mid&#8221;:&#8221;123&#8243;, &#8220;type&#8221;:&#8221;XYZ&#8221;, &#8220;msg&#8221;:&#8221;foo&#8221;, &#8220;T&#8221;:&#8221;2005-09-28 14:38&#8243;, &#8220;L&#8221;:&#8221;warn&#8221;}</font>
</pre>

<p>It identifies an XML document passing through the system using some keys from the envelope. It may seem a strange looking way to log an event, but between the angle brackets lies a useful side effect - it&#8217;s a Python dictionary.   Hence this (vastly oversimplified) example log processing code, that runs eval() on each log line to load the dictionaries into memory:</p>

<pre>
<font color='blue'>Python 2.4 (#60, Nov 30 2004, 11:49:19) [MSC v.1310 32 bit (Intel)] on win32
Type &#8220;help&#8221;, &#8220;copyright&#8221;, &#8220;credits&#8221; or &#8220;license&#8221; for more information.
>>> dicts =[]
>>> import re
>>> p = re.compile(&#8221;.*({.*?}).*&#8221;)
>>> file = open(&#8221;log.txt&#8221;).readlines()
>>> for line in file:
&#8230;     m = p.match(line)
&#8230;     if m:
&#8230;             d = eval(m.group(1))
&#8230;             dicts.append(d)
&#8230;
>>> for d in dicts:
&#8230;    print d
&#8230;
{&#8217;L': &#8216;warn&#8217;, &#8216;mid&#8217;: &#8216;123&#8242;, &#8216;type&#8217;: &#8216;XYZ&#8217;, &#8216;T&#8217;: &#8216;2005-09-28 14:38&#8242;, &#8216;msg&#8217;: &#8216;frobnizer  found&#8217;}
{&#8217;L': &#8216;warn&#8217;, &#8216;mid&#8217;: &#8216;124&#8242;, &#8216;type&#8217;: &#8216;XYZ&#8217;, &#8216;T&#8217;: &#8216;2005-09-28 14:38&#8242;, &#8216;msg&#8217;: &#8216;frobnizer  found&#8217;}
{&#8217;L': &#8216;warn&#8217;, &#8216;mid&#8217;: &#8216;125&#8242;, &#8216;type&#8217;: &#8216;XYZ&#8217;, &#8216;T&#8217;: &#8216;2005-09-28 14:38&#8242;, &#8216;msg&#8217;: &#8216;frobnizer  found&#8217;}
{&#8217;L': &#8216;warn&#8217;, &#8216;mid&#8217;: &#8216;126&#8242;, &#8216;type&#8217;: &#8216;XYZ&#8217;, &#8216;T&#8217;: &#8216;2005-09-28 14:38&#8242;, &#8216;msg&#8217;: &#8216;frobnizer  found&#8217;}
>>></font>
</pre>

<p>What&#8217;s nice about doing this is that it&#8217;s cheap to write the log line in a way that maximises usefulness later on - logs are often an afterthought, but good logging is critical to operating production systems. And it&#8217;s one example where <a href="http://www.tbray.org/ongoing/When/200x/2003/07/29/SearchMeta">creating metadata is cheap</a>.</p>

<p>As well as programming data structures (changing the above to a Ruby hash is straightforward), you can get log lines to output something like <a href="http://www.dajobe.org/2004/01/turtle/">Turtle</a>, which is a greppable RDF format. What&#8217;s good about Turtle in particular is that you can dump or stream a log file straight into an RDF query engine, such as <a href="http://jena.sourceforge.net/ARQ/">ARQ</a> without any transform step and start writing queries against the data. Or how about writing down inferencing rules that help indicate the business consequences of a software error? The log lines themselves don&#8217;t carry enough information, but combined with rules and some context as to where the log event came from you can do interesting and useful things - the biggest issue with any monitoring software is gathering up all those machine level events and contextualising them  so that data (noise) can be turned it into information (signal).  Think of a machine readable data stucture inside logfiles as just another microformat. </p>
				</div>

				<!--
				<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
	    xmlns:dc="http://purl.org/dc/elements/1.1/"
	    xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://lesscode.org/2005/12/13/logging-microformats/"
    dc:identifier="http://lesscode.org/2005/12/13/logging-microformats/"
    dc:title="Logging microformats"
    trackback:ping="http://lesscode.org/2005/12/13/logging-microformats/trackback/" />
</rdf:RDF>				-->
			</div>

				<div class="post">
				<h2 id="post-112"><a href="http://lesscode.org/2005/11/17/ruby-django-meetup/" rel="bookmark" title="Permanent Link to Rails / Django Chicago Debate">Rails / Django Chicago Debate</a>&nbsp;&nbsp;<span><a href="http://lesscode.org/2005/11/17/ruby-django-meetup/#comments" title="Comment on Rails / Django Chicago Debate">9</a> </span></h2>
				<small>Cat.: <a href="http://lesscode.org/category/languages/python/" title="View all posts in Python" rel="category tag">Python</a>,  <a href="http://lesscode.org/category/languages/ruby/" title="View all posts in Ruby" rel="category tag">Ruby</a><br />17. November 2005</small>

				<div class="entry">
					<p>On December 3rd, a mess of fine Chicago area Ruby, Python, and Linux user groups are to <a href="http://snakesandrubies.com/event">meet up</a> at DePaul University for a <a href="http://www.djangoproject.com/">Django</a> / <a href="http://www.rubyonrails.com">Rails</a> love-fest. I&#8217;ve heard there might also be time for debate between songs and hand-holding. <a href="http://www.holovaty.com/">Adrian Holovaty</a>, <a href="http://www.editorandpublisher.com/eandp/news/article_display.jsp?vnu_content_id=1001218795">award winning</a> journalist and distinguished gentlemen, will be fielding questions for the Pythonistas while <a href="http://www.loudthinking.com/">David Heinemeier Hansson</a>, <a href="http://www.loudthinking.com/arc/000522.html">Extraordinary Alien</a> / <a href="http://news.com.com/Ruby+on+Rails+chases+simplicity+in+programming/2100-1007_3-5920169.html?tag=nefd.lede">&#8220;one man&#8221; trying to save the world</a> (hey, I owe him one), will be answering for the Rubyists. </p>

<p>Even better, the <a href="http://snakesandrubies.com/event">Snakes and Rubies</a> website is collecting questions for Adrian or David or both. Get over there and get your questions in before it&#8217;s too late.</p>

<p>If there is any way someone could capture the audio for this event, it would be very much appreciated.</p>
				</div>

				<!--
				<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
	    xmlns:dc="http://purl.org/dc/elements/1.1/"
	    xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://lesscode.org/2005/11/17/ruby-django-meetup/"
    dc:identifier="http://lesscode.org/2005/11/17/ruby-django-meetup/"
    dc:title="Rails / Django Chicago Debate"
    trackback:ping="http://lesscode.org/2005/11/17/ruby-django-meetup/trackback/" />
</rdf:RDF>				-->
			</div>

				<div class="post">
				<h2 id="post-107"><a href="http://lesscode.org/2005/10/27/rails-simplest-plugin-manager/" rel="bookmark" title="Permanent Link to Simplest Possible Plugin Manager For Rails">Simplest Possible Plugin Manager For Rails</a>&nbsp;&nbsp;<span><a href="http://lesscode.org/2005/10/27/rails-simplest-plugin-manager/#comments" title="Comment on Simplest Possible Plugin Manager For Rails">6</a> </span></h2>
				<small>Cat.: <a href="http://lesscode.org/category/languages/ruby/" title="View all posts in Ruby" rel="category tag">Ruby</a>,  <a href="http://lesscode.org/category/by-stack/rails/" title="View all posts in Rails" rel="category tag">Rails</a><br />27. October 2005</small>

				<div class="entry">
					<p><strong>UPDATE</strong>: I ended up making some pretty massive changes. You can configure multiple plugin repositories,  install, update, remove, and discover plugins. The directions for installation are still valid but you&#8217;ll need to run <code>plugin --help</code> to get a feel for the changes in usage.</p>

<hr />

<p><strong>UPDATE</strong>: The plugin manager has been included with <a href="http://weblog.rubyonrails.com/articles/2005/11/07/rails-1-0-rc4-0-14-3-its-the-final-countdown">Rails 1.0 RC4</a>. 
Run <code>script/plugin --help</code> from a fresh Rails app for usage information.</p>

<hr />

<p><a href="http://documentation.rubyonrails.com/release_notes/rc2.html">Rails 1.0 RC1</a> shipped with a simple plugin system - drop a directory under <code>vendor/plugins</code> that contains an <code>init.rb</code> file to be executed at configuration time and an optional <code>lib</code> directory to be placed on the path. Do whatever you please from there. It&#8217;s a simple hook into the startup cycle and a much needed addition.</p>

<p>About 19 hours ago, <a href="http://weblog.rubyonrails.com/archives/2005/10/26/tracking-plugins-temporarily-on-the-wiki">David suggested that people link to their plugins from the Rails Wiki</a> as a kind of interim solution to the problem of not having a standard means of packaging and managing these things. They did and with links to their plugins&#8217; subversion repositories.</p>

<p>Here&#8217;s <a href="http://lesscode.org/svn/rtomayko/rails/scripts/plugin">a simple (150 line) plugin manager</a>.  </p>

<p>Install it like this:</p>

<pre><code>$ cd my-rails-app
$ curl http://lesscode.org/svn/rtomayko/rails/scripts/plugin &gt; script/plugin
$ chmod +x script/plugin
</code></pre>

<p>Then see what plugins are available:</p>

<pre><code>$ ./script/plugin
continuous_builder  http://dev.rubyonrails.com/svn/rails/plugins/continuous_builder
asset_timestamping  http://svn.aviditybytes.com/rails/plugins/asset_timestamping
enumerations_mixin  http://svn.protocool.com/rails/plugins/enumerations_mixin/trunk
calculations        http://techno-weenie.net/svn/projects/calculations/
...
</code></pre>

<p>Next, install stuff to your <code>vendor/plugins</code> directory:</p>

<pre><code>$ ./script/plugin continuous_builder asset_timestamping
</code></pre>

<p>Here&#8217;s how it works:</p>

<ol>
<li><p>Scrape the <a href="http://wiki.rubyonrails.org/rails/pages/Plugins">Plugin page</a> for things that look like subversion repositories with plugins. (Yes, I&#8217;m using regular expressions. Yes, I understand the issues. No, I don&#8217;t care.)</p></li>
<li><p>If <code>vendor/plugins</code> is under subversion control, the script will modify the <code>svn:externals</code> property on that directory and perform an update. You can use normal subversion commands to keep the plugins up to date.</p></li>
<li><p>Or, if <code>vendor/plugins</code> is not under subversion control, the plugin is pulled via <code>svn export</code>.</p></li>
</ol>

<p>If you want to use <code>svn:externals</code>, make sure you have your <code>vendor/plugins</code> directory under subversion&#8217;s control <em>before</em> installing any plugins . If your not sure, do something like this:</p>

<pre><code>$ svn info vendor/plugins
foo:    (Not a versioned resource)
$ svn mkdir vendor/plugins
$ svn ci -m "adding teh plugins directory so I can use this r0x3ring plugin manager..."
</code></pre>

<p>This probably won&#8217;t work on Windows at the moment and assumes you have the command line subversion client utilities available (<code>svn</code>).</p>

<p>It&#8217;s useful as is, but please, make it better.</p>
				</div>

				<!--
				<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
	    xmlns:dc="http://purl.org/dc/elements/1.1/"
	    xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://lesscode.org/2005/10/27/rails-simplest-plugin-manager/"
    dc:identifier="http://lesscode.org/2005/10/27/rails-simplest-plugin-manager/"
    dc:title="Simplest Possible Plugin Manager For Rails"
    trackback:ping="http://lesscode.org/2005/10/27/rails-simplest-plugin-manager/trackback/" />
</rdf:RDF>				-->
			</div>

				<div class="post">
				<h2 id="post-90"><a href="http://lesscode.org/2005/09/25/fun-with-fixtures/" rel="bookmark" title="Permanent Link to Fun with Fixtures">Fun with Fixtures</a>&nbsp;&nbsp;<span><a href="http://lesscode.org/2005/09/25/fun-with-fixtures/#comments" title="Comment on Fun with Fixtures">2</a> </span></h2>
				<small>Cat.: <a href="http://lesscode.org/category/languages/ruby/" title="View all posts in Ruby" rel="category tag">Ruby</a>,  <a href="http://lesscode.org/category/by-stack/rails/" title="View all posts in Rails" rel="category tag">Rails</a><br />25. September 2005</small>

				<div class="entry">
					<p>My favorite part of <a href="http://www.amazon.com/exec/obidos/tg/detail/-/097669400X/102-5075999-2240140?v=glance" title="Buy this book.">Agile Web Development with Rails</a> is the
section on testing. I&#8217;ve found the framework around testing included
with Rails to be a wonderful blend of simplicity and power and this
chapter in the book is the perfect compliment. It&#8217;s based largely on the
core Ruby <a href="http://www.ruby-doc.org/docs/rdoc/1.9/classes/Test.html" title="RDoc documentation for the Ruby 'Test::Unit' module">Test::Unit</a> module but adds some important features on
top.</p>

<p>One of those features is <a href="http://api.rubyonrails.com/classes/Fixtures.html" title="RDoc documentation for the Rails 'Fixtures' module">Fixtures</a>. Fixtures provide a simple,
<a href="http://www.yaml.org/" title="YAML Ain't Markup Language">YAML</a>-based file format for storing database state that should be
loaded before test runs. The database is wiped and the fixtures are
loaded before each individual test executes, providing consistent state
for tests. See the <a href="http://manuals.rubyonrails.com/read/chapter/26">section on
fixtures</a> in <a href="http://manuals.rubyonrails.com/read/book/5">A Guide to
Testing the Rails</a> for more
information. Here&#8217;s an example fixture from said section:</p>

<pre><code># low &amp; behold!  I am a YAML comment!
david:
 id: 1 
 name: David Heinemeier Hansson 
 birthday: 1979-10-15 
 profession: Systems development

steve:
 id: 2
 name: Steve Ross Kellock
 birthday: 1974-09-27
 profession: guy with keyboard
</code></pre>

<p>The cool thing is that the top level fixture names (in this case,
&#8220;david&#8221; and &#8220;steve&#8221;) become instance variables in your test case,
allowing you to access fixture data in a very intuitively way from
tests. The result of this is test code that reads like a story and is
often almost humorous.</p>

<p><a href="http://www.amazon.com/exec/obidos/tg/detail/-/097669400X/102-5075999-2240140?v=glance" title="Buy this book.">The book</a> includes a sidebar with a little
<a href="http://www.loudthinking.com/">David</a> head lamenting the importance of
&#8220;Picking Good Fixture Names&#8221;:</p>

<p><img src="http://static.flickr.com/33/46283282_2bc2441998_o.png" 
     float="left" style="float: left; padding: 1em 2em; margin-left: 1em" /></p>

<blockquote>
  <p>Just like the names of variables in general, you want to keep the
  names of fixtures as self-explanatory as possible. This increases the
  readability of the tests when you&#8217;re asserting that
  <code>@valid_order_for_fred</code> is indeed Fred&#8217;s valid order. It also makes it a
  lot easier to remember which fixture you&#8217;re supposed to test against
  without having to look up <code>p1</code> or <code>order4</code>. The more fixtures you get, the
  more important it is to pick good fixture names. So, starting early
  keeps you happy later.</p>
  
  <p>But what to do with fixtures that can&#8217;t easily get a self-explanatory
  name like <code>@valid_order_for_fred?</code> Pick natural names that you have an
  easier time associating to a role. For example, instead of using
  <code>order1</code>, use <code>christmas_order</code>. Instead of <code>customer1</code>, use <code>fred</code>. Once
  you get into the habit of natural names, youâ€™ll soon be weaving a nice
  little story about how <code>fred</code> is paying for his <code>christmas_order</code> with
  his <code>invalid_credit_card</code> first, then paying his <code>valid_credit_card</code>, and
  finally choosing to ship it all off to <code>aunt_mary</code>.  </p>
  
  <p><strong>Association-based stories are key to remembering large worlds of
  fixtures with ease.</strong></p>
</blockquote>

<p>Taking this advice, I started in on testing a part of an application I&#8217;m
working on now. The result is worth posting in it&#8217;s entirety (hint: it gets
interesting towards the middle):</p>

<pre style="font-size: 110%; line-spacing: 120%; border: 0; margin-left: 0; padding-left: 0">
<B><FONT COLOR="#5F9EA0">require</FONT></B> File.dirname(__FILE__) + <B><FONT COLOR="#BC8F8F">&#8216;/../test_helper&#8217;</FONT></B>

<B><FONT COLOR="#A020F0">class</FONT></B> EnrolleeTest &lt; Test::Unit::TestCase
  fixtures :coverage_types, :plans, :coverages, :plan_levels, :ppo_options,
           :elections, :enrollees, :enrollments, :tpas, :tpas_users, :users,
           :roles

  <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">setup
</FONT></B>    <FONT COLOR="#B8860B">@joe</FONT> = Enrollee.find(<FONT COLOR="#B8860B">@joe_the_policy_holder</FONT>.id)
    <FONT COLOR="#B8860B">@rita</FONT> = Enrollee.find(<FONT COLOR="#B8860B">@rita_the_spouse</FONT>.id)
    <FONT COLOR="#B8860B">@billy</FONT> = Enrollee.find(<FONT COLOR="#B8860B">@billy_the_dependent</FONT>.id)
    <FONT COLOR="#B8860B">@alice</FONT> = Enrollee.find(<FONT COLOR="#B8860B">@alice_the_dependent</FONT>.id)
    <FONT COLOR="#B8860B">@the_family</FONT> = [<FONT COLOR="#B8860B">@joe</FONT>, <FONT COLOR="#B8860B">@rita</FONT>, <FONT COLOR="#B8860B">@billy</FONT>, <FONT COLOR="#B8860B">@alice</FONT>]
    <FONT COLOR="#B8860B">@enrollment</FONT> = Enrollment.find(<FONT COLOR="#B8860B">@test_enrollment</FONT>.id)
  <B><FONT COLOR="#A020F0">end</FONT></B>

  <I><FONT COLOR="#B22222">
</FONT></I>  <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">test_common_attrs
</FONT></B>    <FONT COLOR="#B8860B">@the_family</FONT>.each <B><FONT COLOR="#A020F0">do</FONT></B> |enrollee|
      assert_kind_of Enrollee, enrollee
      assert_equal <FONT COLOR="#B8860B">@enrollment</FONT>.id, enrollee.enrollment_id
      assert_equal <FONT COLOR="#B8860B">@enrollment</FONT>, enrollee.enrollment
      assert_equal <FONT COLOR="#B8860B">@joe</FONT>.id, enrollee.policy_holder_id
      assert_equal <FONT COLOR="#B8860B">@joe</FONT>, enrollee.policy_holder
    <B><FONT COLOR="#A020F0">end</FONT></B>
  <B><FONT COLOR="#A020F0">end</FONT></B>

  <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">test_get_gender
</FONT></B>    assert_equal :male, <FONT COLOR="#B8860B">@joe</FONT>.gender, <B><FONT COLOR="#BC8F8F">&quot;Joe is a male&quot;</FONT></B>
    assert <FONT COLOR="#B8860B">@joe</FONT>.male?, <B><FONT COLOR="#BC8F8F">&quot;Joe is a male&quot;</FONT></B>
    assert_equal :female, <FONT COLOR="#B8860B">@rita</FONT>.gender, <B><FONT COLOR="#BC8F8F">&quot;Rita is a female&quot;</FONT></B>
    assert <FONT COLOR="#B8860B">@rita</FONT>.female?, <B><FONT COLOR="#BC8F8F">&quot;Rita is a female&quot;</FONT></B>
    assert !<FONT COLOR="#B8860B">@billy</FONT>.female?, <B><FONT COLOR="#BC8F8F">&quot;Billy is not a female&quot;</FONT></B>
    assert !<FONT COLOR="#B8860B">@alice</FONT>.male?, <B><FONT COLOR="#BC8F8F">&quot;Sally is not a male&quot;</FONT></B>
  <B><FONT COLOR="#A020F0">end</FONT></B>

  <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">test_set_gender
</FONT></B>    [:female, <B><FONT COLOR="#BC8F8F">&#8216;F&#8217;</FONT></B>, 2].each <B><FONT COLOR="#A020F0">do</FONT></B> |tok|
      <FONT COLOR="#B8860B">@joe</FONT>.gender = tok
      assert_equal :female, <FONT COLOR="#B8860B">@joe</FONT>.gender, <B><FONT COLOR="#BC8F8F">&quot;Joe is now a female&quot;</FONT></B>
      assert <FONT COLOR="#B8860B">@joe</FONT>.save, <B><FONT COLOR="#BC8F8F">&quot;Joe could not be saved after sex change&quot;</FONT></B>
      <FONT COLOR="#B8860B">@joe</FONT>.reload
      assert_equal :female, <FONT COLOR="#B8860B">@joe</FONT>.gender, <B><FONT COLOR="#BC8F8F">&quot;Joe is now a female&quot;</FONT></B>
    <B><FONT COLOR="#A020F0">end</FONT></B>

    [:male, <B><FONT COLOR="#BC8F8F">&#8216;M&#8217;</FONT></B>, 1].each <B><FONT COLOR="#A020F0">do</FONT></B> |tok|
      <FONT COLOR="#B8860B">@rita</FONT>.gender = tok
      assert_equal :male, <FONT COLOR="#B8860B">@rita</FONT>.gender, <B><FONT COLOR="#BC8F8F">&quot;Rita is now a male&quot;</FONT></B>
      assert <FONT COLOR="#B8860B">@rita</FONT>.save, <B><FONT COLOR="#BC8F8F">&quot;Rita could not be saved after sex change&quot;</FONT></B>
      <FONT COLOR="#B8860B">@rita</FONT>.reload
      assert_equal :male, <FONT COLOR="#B8860B">@rita</FONT>.gender, <B><FONT COLOR="#BC8F8F">&quot;Rita is now a male&quot;</FONT></B>
    <B><FONT COLOR="#A020F0">end</FONT></B>

    <I><FONT COLOR="#B22222"># make sure that we can set it to nil
</FONT></I>    <FONT COLOR="#B8860B">@joe</FONT>.gender = <B><FONT COLOR="#A020F0">nil</FONT></B>
    assert_equal <B><FONT COLOR="#A020F0">nil</FONT></B>, <FONT COLOR="#B8860B">@joe</FONT>.gender
    assert <FONT COLOR="#B8860B">@joe</FONT>.save(<B><FONT COLOR="#A020F0">false</FONT></B>), <B><FONT COLOR="#BC8F8F">&quot;Joe couldn&#8217;t be saved after neutering&#8230;&quot;</FONT></B>
    <FONT COLOR="#B8860B">@joe</FONT>.reload
    assert_equal <B><FONT COLOR="#A020F0">nil</FONT></B>, <FONT COLOR="#B8860B">@joe</FONT>.gender

    <FONT COLOR="#B8860B">@joe</FONT>.gender = <B><FONT COLOR="#BC8F8F">&#8216;&#8217;</FONT></B>
    assert_equal <B><FONT COLOR="#A020F0">nil</FONT></B>, <FONT COLOR="#B8860B">@joe</FONT>.gender
    assert <FONT COLOR="#B8860B">@joe</FONT>.save(<B><FONT COLOR="#A020F0">false</FONT></B>), <B><FONT COLOR="#BC8F8F">&quot;Joe couldn&#8217;t be saved after neutering&#8230;&quot;</FONT></B>
    <FONT COLOR="#B8860B">@joe</FONT>.reload
    assert_equal <B><FONT COLOR="#A020F0">nil</FONT></B>, <FONT COLOR="#B8860B">@joe</FONT>.gender
  <B><FONT COLOR="#A020F0">end</FONT></B>

  <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">test_marital_status
</FONT></B>    assert_equal :married, <FONT COLOR="#B8860B">@joe</FONT>.marital_status
    assert <FONT COLOR="#B8860B">@joe</FONT>.married?, <B><FONT COLOR="#BC8F8F">&quot;Joe is married&quot;</FONT></B>
    assert !<FONT COLOR="#B8860B">@joe</FONT>.single?, <B><FONT COLOR="#BC8F8F">&quot;Joe is not single&quot;</FONT></B>
    assert <FONT COLOR="#B8860B">@billy</FONT>.single?, <B><FONT COLOR="#BC8F8F">&quot;Billy is single&quot;</FONT></B>
    assert !<FONT COLOR="#B8860B">@billy</FONT>.married?, <B><FONT COLOR="#BC8F8F">&quot;Billy is not married&quot;</FONT></B>
    assert_equal :single, <FONT COLOR="#B8860B">@billy</FONT>.marital_status
  <B><FONT COLOR="#A020F0">end</FONT></B>

  <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">test_set_marital_status
</FONT></B>    [:married, 2].each <B><FONT COLOR="#A020F0">do</FONT></B> |tok|
      <FONT COLOR="#B8860B">@billy</FONT>.marital_status = tok
      assert_equal :married, <FONT COLOR="#B8860B">@billy</FONT>.marital_status
      assert <FONT COLOR="#B8860B">@billy</FONT>.save, <B><FONT COLOR="#BC8F8F">&quot;Billy could not be saved after he got married&quot;</FONT></B>
      <FONT COLOR="#B8860B">@billy</FONT>.reload
      assert_equal :married, <FONT COLOR="#B8860B">@billy</FONT>.marital_status
    <B><FONT COLOR="#A020F0">end</FONT></B>

    [:single, 1].each <B><FONT COLOR="#A020F0">do</FONT></B> |tok|
      <FONT COLOR="#B8860B">@rita</FONT>.marital_status = tok
      assert_equal :single, <FONT COLOR="#B8860B">@rita</FONT>.marital_status
      assert <FONT COLOR="#B8860B">@rita</FONT>.save, <B><FONT COLOR="#BC8F8F">&quot;Rita could not be saved after her divorce&quot;</FONT></B>
      <FONT COLOR="#B8860B">@rita</FONT>.reload
      assert_equal :single, <FONT COLOR="#B8860B">@rita</FONT>.marital_status
    <B><FONT COLOR="#A020F0">end</FONT></B>
  <B><FONT COLOR="#A020F0">end</FONT></B>
<B><FONT COLOR="#A020F0">end</FONT></B>
</pre>

<p>:)</p>
				</div>

				<!--
				<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
	    xmlns:dc="http://purl.org/dc/elements/1.1/"
	    xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://lesscode.org/2005/09/25/fun-with-fixtures/"
    dc:identifier="http://lesscode.org/2005/09/25/fun-with-fixtures/"
    dc:title="Fun with Fixtures"
    trackback:ping="http://lesscode.org/2005/09/25/fun-with-fixtures/trackback/" />
</rdf:RDF>				-->
			</div>

		
		<div class="navigation">
			<div class="alignleft"><a href="http://lesscode.org/category/languages/ruby/page/2/">&laquo; previous</a></div>
			<div class="alignright"><a href="http://lesscode.org/category/languages/ruby/page/2/"></a></div>
		</div>

	
	</div>


<div id="footer">
	<p style="float: left;">
		feeds: 
    <a href="http://lesscode.org/feed/atom/" title="Atom 0.3 feed for all posts">
      posts</a> (<a href="http://feedvalidator.org/check.cgi?url=http://lesscode.org/feed/atom/">valid?</a>)
    or <a href="http://lesscode.org/comments/feed/" title="RSS 2.0 feed for comments">comments</a>
       (<a href="http://feedvalidator.org/check.cgi?url=http://lesscode.org/comments/feed/">valid?</a>)
    <br />
		design by <a href="http://blog.ratterobert.com/">ratter / robert</a><br />
		powered by <a href="http://wordpress.org">WordPress</a>.<a href="http://wordpress.de">de</a><br />
	</p>
		<a name="search"><form method="get" id="searchform" action="/index.php">
<div><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</a>
</div>
<div id="switcher">
	<center>
			</center>
</div>
</div>
		</body>
</html>

<!-- Dynamic Page Served (once) in 0.490 seconds -->
