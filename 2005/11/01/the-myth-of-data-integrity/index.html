<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" 
        content="text/html; charset=UTF-8" />

  <title>  The Myth Of Data Integrity</title>
	<meta name="generator" content="WordPress 2.0.1" />

	<link rel="stylesheet" href="http://lesscode.org/wp-content/themes/almodovar/style.css" type="text/css" media="screen" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://lesscode.org/feed/" />
	<link rel="alternate" type="text/xml" title="RSS .92" href="http://lesscode.org/feed/rss/" />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://lesscode.org/feed/atom/" />
	<link rel="pingback" href="http://lesscode.org/xmlrpc.php" />

        <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
        </script>
        <script type="text/javascript">
        _uacct = "UA-125803-1";
        urchinTracker();
        </script>
		<link rel='archives' title='October 2006' href='http://lesscode.org/2006/10/' />
	<link rel='archives' title='April 2006' href='http://lesscode.org/2006/04/' />
	<link rel='archives' title='March 2006' href='http://lesscode.org/2006/03/' />
	<link rel='archives' title='January 2006' href='http://lesscode.org/2006/01/' />
	<link rel='archives' title='December 2005' href='http://lesscode.org/2005/12/' />
	<link rel='archives' title='November 2005' href='http://lesscode.org/2005/11/' />
	<link rel='archives' title='October 2005' href='http://lesscode.org/2005/10/' />
	<link rel='archives' title='September 2005' href='http://lesscode.org/2005/09/' />
	<link rel='archives' title='August 2005' href='http://lesscode.org/2005/08/' />
	<link rel='archives' title='July 2005' href='http://lesscode.org/2005/07/' />
	<link rel='archives' title='June 2005' href='http://lesscode.org/2005/06/' />
	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://lesscode.org/xmlrpc.php?rsd" />
<script type="text/javascript">
/*-----AJAX-Comment-Preview-Variables-----*/
	var inputId     = 'comment';
	var outputId    = 'ajax-comment-preview';
	var doitId      = 'preview';
	var authorId    = 'author';
	var urlId       = 'url';
	var processURI  = '/wp-content/plugins/ajax-comment-preview.php';
	var emptyString = 'Click the "Preview" button to preview your comment here.';
/*----------------------------------------*/
</script>
<script type="text/javascript" src="/wp-content/plugins/ajax-comment-preview.js"></script>
</head>
<body>

<div id="page">
<h1><a href="http://lesscode.org">lesscode.org</a></h1>
<div id="navcontainer">
		<ul id="navlist">
			<li class="page_item"><a href="http://lesscode.org/archives/" title="archives">archives</a></li>
<li class="page_item"><a href="http://lesscode.org/about/" title="about lesscode.org">about lesscode.org</a></li>
		</ul>
</div>
<hr />

	<div id="content" class="narrowcolumn">

  
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="http://lesscode.org/2005/10/28/microformats-zen/">The Zen of Microformats</a></div>
			<div class="alignright"> <a href="http://lesscode.org/2005/11/02/half-a-baby-step/">Half a Baby Step</a> &raquo;</div>
		</div>

		<div class="post">
			<h2 id="post-109"><a href="http://lesscode.org/2005/11/01/the-myth-of-data-integrity/" rel="bookmark" title="Permanent Link: The Myth Of Data Integrity">The Myth Of Data Integrity</a>&nbsp;&nbsp;</h2>
			<small>By <a href="http://www.jooto.com/blog">Alex Bunardzic</a>
      under <a href="http://lesscode.org/category/by-stack/rails/" title="View all posts in Rails" rel="category tag">Rails</a> 
      on 01. November 2005</small>

			<div class="entrytext">
				<p>Another longish post that I wrote, this time it&#8217;s about the <a href="http://jooto.com/blog/index.php/2005/11/01/the-myth-of-data-integrity/">The Myth Of Data Integrity</a> (posted on my blog). I was inspired by David&#8217;s interview on c|net news.com (<a href="http://news.com.com/Ruby+on+Rails+chases+simplicity+in+programming/2100-1007_3-5920169.html?tag=nefd.lede">Simplicity in Programming</a>).</p>

<p>Controversial? You bet. Challenge the status quo!</p>

				
        <a name="comments"> </a>
				<p class="postmetadata alter">
					<a href='http://lesscode.org/2005/11/01/the-myth-of-data-integrity/feed/'>Comment <acronym title="Really Simple Syndication">RSS</acronym></a> -

													<a href="http://lesscode.org/2005/11/01/the-myth-of-data-integrity/trackback/">Trackback <acronym title="Uniform Resource Identifier">URI</acronym></a>

						
				</p>

			</div>
		</div>

	
<!-- You can start editing here. -->

	<h3 id="comments">8 Responses to &#8220;The Myth Of Data Integrity&#8221;</h3>

	<ol class="commentlist">
  	
		<li class="alt" id="comment-718">
			<p class="who"><cite>Anonymous</cite>:</p>
			<p>So&#8230; wrong.</p>
      <p>
			<small>comment at <a href="#comment-718" title="">01. November 2005</a> </small>
						</p>

		</li>

	
	
		<li class="alt" id="comment-719">
			<p class="who"><cite><a href='http://www.openpolitics.com/pieces/' rel='external ' title='4.239.165.7'>Daniel</a></cite>:</p>
			<p>Alex Bunardzic wrote an article on database integrity in which he completely dismissed commonly accepted methods of using an RDBMS to enforce data integrity. I strongly disagree with his conclusions. In fact, I think his arguments are terrible.</p>
<p><a href="http://www.openpolitics.com/pieces/archives/001768.html">Continue reading&#8230;</a></p>
      <p>
			<small>comment at <a href="#comment-719" title="">02. November 2005</a> </small>
						</p>

		</li>

	
	
		<li class="alt" id="comment-720">
			<p class="who"><cite>Anonymous</cite>:</p>
			<p>I&#8217;m realling getting fed up of these nonsensical and unsubstantiated articles from the Agile Methodologies front.  Everyday someone jumps on the bandwagon, spurts a random blog entry and maybe enjoys being &#8220;controversial&#8221; after having been debunked by 99% of the readers.</p>
<p>What would you do if someone claims that the earth is flat, and starts becoming famous thanks to his &#8220;controversial&#8221; theories?  You may demonstrate his claims to be false, or just ignore him.  By choosing the first option, the risk is to feed the debate and his fame as well.</p>
<p>I think that I&#8217;ll ignore these people, starting from now.  They will happily drown in their &#8220;agile&#8221; mud when their methodologies will collide with real-world non-trivial development problems.</p>
      <p>
			<small>comment at <a href="#comment-720" title="">02. November 2005</a> </small>
						</p>

		</li>

	
	
		<li class="alt" id="comment-725">
			<p class="who"><cite><a href='http://pobox.com/~kragen' rel='external ' title='209.157.132.93'>Kragen Sitaker</a></cite>:</p>
			<p>Alex&#8217;s article isn&#8217;t controversial.  It&#8217;s just stupid.  He&#8217;s grasping at an understanding of some things other people have said, and missing.</p>
<p>Here&#8217;s what <b>I</b> think of constraints in the database, based on a scant few years of experience building a small number of database-backed web apps.  I promise not to use any stupid similes.</p>
<p>If there&#8217;s some validity constraint in the database that&#8217;s not reflected in your application code, you still lose.  If you try to delete some row that a foreign key constraint requires to exist, and the database stops you, your application code has three choices.  It can display the database&#8217;s error message to the user; it can pretend that the transaction succeeded; it can retry (not that this is a good idea, but I&#8217;ve seen it done); or it can display a content-free &#8220;general failure&#8221; message.</p>
<p>Assuming your application&#8217;s users don&#8217;t understand the underlying table structure and the RDBMSese in which the error message is phrased, none of these four options are acceptable.  So putting validity constraints in the database doesn&#8217;t save you from also putting them in your code.  (If there&#8217;s only one possible way a particular statement can fail, then you can catch the failure and turn it into an appropriate error message or change in behavior; but that still requires putting the knowledge of the data integrity constraint in your application code.)</p>
<p>Now we have a maintenance problem: two copies of the constraint, in very different forms, that must be modified in parallel.  This is a heavy cost, but that&#8217;s not the end of it; putting your constraints in the database has three other major drawbacks.</p>
<p>Checking the correctness of an update can be done (and must be done, as explained above) in application code, which can be distributed across a large number of front-end machines if your application has to scale.  If you check the correctness of the update again in the database, it will cost you a great deal more money to scale to larger numbers of users, and you will hit a much lower ceiling.</p>
<p>Database integrity constraints are difficult to check in and out of a source control system, unless your &#8220;build process&#8221; involves reinitializing with an empty database.  This leads to spending a lot of time looking for phantom bugs when your development database has a stale constraint, or lacks one that will exist on the production machine.</p>
<p>Finally, database integrity constraints tend to cause problems with things like backup and restore.  It&#8217;s true that if they are correctly implemented (both the constraints and the backup/restore process) then no such problems will arise.  In the real world, though, it is often a real problem.</p>
<p>Fundamentally the issue is that relational databases are being deployed as application-internal object stores mediated by object-relational mappers.  Both relational databases and object stores are fine things, but they have very different design requirements.  A relational database is intended to be interacted with directly some of the time; SQL is a carefully designed user interface for this purpose.  It&#8217;s designed to serve as a shared data store among several different applications, some of which may be written in COBOL and thus have very definite ideas about how long certain strings should be.  An object store is intended to hide inside a program and be easy to refactor.  (I&#8217;m leaving aside the issue of the relational data model and the object-reference-graph model, which is important, but not as important.)  </p>
<p>Many useful features of relational databases, such as multi-column primary keys, string length limits, triggers, foreign key constraints, users and their associated permissions, and so forth, are simply not useful when the database is being deployed as an internal object store for some application.</p>
<p>That&#8217;s the story behind the real &#8220;agile people don&#8217;t like database integrity constraints&#8221; issue.</p>
<p>I&#8217;ve spent a few years developing software with XP, and I don&#8217;t appreciate being lumped in with clueless seekers of controversy like Alex Bunardzic.</p>
      <p>
			<small>comment at <a href="#comment-725" title="">03. November 2005</a> </small>
						</p>

		</li>

	
	
		<li class="alt" id="comment-726">
			<p class="who"><cite><a href='http://pobox.com/~kragen' rel='external ' title='209.157.132.93'>Kragen Sitaker</a></cite>:</p>
			<p>I guess I should point out that RDBMSes make the best object stores I&#8217;ve had the chance to use, even though that isn&#8217;t really what they&#8217;re designed for.  I haven&#8217;t had the opportunity to use persistence software that&#8217;s really designed for object-reference graphs that does even a fraction of what MySQL 2.0 did.</p>
      <p>
			<small>comment at <a href="#comment-726" title="">03. November 2005</a> </small>
						</p>

		</li>

	
	
		<li class="alt" id="comment-732">
			<p class="who"><cite><a href='http://www.jooto.com/blog' rel='external ' title='198.73.138.2'>Alex Bunardzic</a></cite>:</p>
			<p>Not to clog the lesscode&#8217;s bandwidth, I have posted some of the responses to the criticisms here:</p>
<p><a href="http://jooto.com/blog/index.php/2005/11/03/more-on-data-integrity/">More on data integrity</a></p>
      <p>
			<small>comment at <a href="#comment-732" title="">03. November 2005</a> </small>
						</p>

		</li>

	
	
		<li class="alt" id="comment-733">
			<p class="who"><cite>Ben Finney</cite>:</p>
			<p><a href="#comment-725">Kragen</a> wrote:</p>
<blockquote>
<p>If you try to delete some row that a foreign key constraint requires to exist, and the<br />
  database stops you, your application code has three choices. It can display the<br />
  database’s error message to the user; it can pretend that the transaction succeeded; it<br />
  can retry (not that this is a good idea, but I’ve seen it done); or it can display a<br />
  content-free “general failure” message.</p>
</blockquote>
<p>Two problems:</p>
<ul>
<li>
<p>that&#8217;s four options, not three :-)</p>
</li>
<li>
<p>you&#8217;ve missed (at least) one viable option.</p>
</li>
</ul>
<p>The code should be aware that the transaction can fail, but let the RDBMS do the job of <em>enforcing</em> the data integrity. If the transation succeeds, fine! The application hasn&#8217;t had to do any checking before that happens, and it can continue on with the rest of the job. If the transaction fails, the code knows immediately, and can then proceed with whatever recovery action the programmer deems necessary.</p>
<p>You make the point that the application code need to know about the constraint; that&#8217;s only true in that the application needs to deal with the case when the constraint is violated. But why not pass the actual <em>enforcement</em> off to the RDBMS, and have the application just deal with how to handle that result?</p>
      <p>
			<small>comment at <a href="#comment-733" title="">03. November 2005</a> </small>
						</p>

		</li>

	
	
		<li class="alt" id="comment-749">
			<p class="who"><cite><a href='http://pobox.com/~kragen/' rel='external ' title='157.22.247.20'>Kragen Sitaker</a></cite>:</p>
			<p>Ben Finney writes: </p>
<blockquote><p>that’s four options, not three :-)</p></blockquote>
<p>Oops, you&#8217;re right &#8212; thanks :)</p>
<blockquote><p>
You make the point that the application code need to know about the constraint; that’s only true in that the application needs to deal with the case when the constraint is violated. But why not pass the actual enforcement off to the RDBMS, and have the application just deal with how to handle that result?
</p></blockquote>
<p>The three, um, four alternatives I outlined are different ways to have the application deal with how to handle that result; in other words, they are the choices available as &#8220;recovery actions&#8221; to the programmer.  I argued that each of them is unacceptable for software intended for end-users (that is, someone not conversant with the underlying database schema).  Is there a better alternative I haven&#8217;t thought of, or do you think that one of those four choices is acceptable in that context?</p>
      <p>
			<small>comment at <a href="#comment-749" title="">15. November 2005</a> </small>
						</p>

		</li>

	
	        
	</ol>

 


<h3 id="respond">Leave a Reply</h3>


<form action="http://lesscode.org/wp-comments-post.php" method="post" id="commentform">


<p>
  <small>
    <strong>Note:</strong> None of this information is required but 
    leaving a Name and URL is much appreciated. You can also <a href="/wp-register.php">register</a>
    to have this stuff remembered.
  </small>
</p>

<p><input type="text" name="author" id="author" value="" size="22" tabindex="1" />
<label for="author"><small>Name </small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2" />
<label for="email"><small>Mail (will not be published) </small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3" />
<label for="url"><small>Website</small></label></p>


<div id="ajax-comment-preview" style="padding: .4em 0; color: #666; margin-top: 1em; border-top: 1px solid #ddd; border-bottom: 1px solid #ddd">Your comment can be previewed here.</div>

<p>
  <br />
  <small>
    <strong><a href="http://daringfireball.net/projects/markdown/syntax"
       title="Markdown Syntax Reference">Markdown</a>:</strong> 
    use the force, Luke.
  </small>
</p>

<p>
  <textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea>
</p>

<p>
  <input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment" />
<input type="hidden" name="comment_post_ID" value="109" />
</p>
<input name="preview" type="button" id="preview" tabindex="6" value="Preview" /><div id="ajax-comment-preview"></div>
</form>



	
	</div>


<div id="footer">
	<p style="float: left;">
		feeds: 
    <a href="http://lesscode.org/feed/atom/" title="Atom 0.3 feed for all posts">
      posts</a> (<a href="http://feedvalidator.org/check.cgi?url=http://lesscode.org/feed/atom/">valid?</a>)
    or <a href="http://lesscode.org/comments/feed/" title="RSS 2.0 feed for comments">comments</a>
       (<a href="http://feedvalidator.org/check.cgi?url=http://lesscode.org/comments/feed/">valid?</a>)
    <br />
		design by <a href="http://blog.ratterobert.com/">ratter / robert</a><br />
		powered by <a href="http://wordpress.org">WordPress</a>.<a href="http://wordpress.de">de</a><br />
	</p>
		<a name="search"><form method="get" id="searchform" action="/index.php">
<div><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</a>
</div>
<div id="switcher">
	<center>
			</center>
</div>
</div>
		</body>
</html>

<!-- Dynamic Page Served (once) in 0.371 seconds -->
<!-- Cached page served by WP-Cache -->
